<!DOCTYPE html>
<html lang="en" class="light">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>String Utilities - Turbo Pascal Programs</title>
<meta name="description" content="String Utilities - Turbo Pascal program by Kirill Arkhipenko (kusaku, retrewert, aks1983).">
<meta name="keywords" content="Kirill Arkhipenko, Кирилл Архипенко, kusaku, retrewert, aks1983, legacy">
<meta name="author" content="Kirill Arkhipenko">
<link rel="canonical" href="https://kusaku.su/legacy/turbopascal/mp3tager/string-utilities.html">
<link rel="alternate" hreflang="en" href="https://kusaku.su/legacy/turbopascal/mp3tager/string-utilities.html">
<link rel="alternate" hreflang="ru" href="https://kusaku.su/legacy/turbopascal/mp3tager/string-utilities.html">
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<meta name="robots" content="index, follow">
<meta property="og:title" content="String Utilities - Turbo Pascal Programs">
<meta property="og:description" content="String Utilities - Turbo Pascal program by Kirill Arkhipenko (kusaku, retrewert, aks1983).">
<meta property="og:url" content="https://kusaku.su/legacy/turbopascal/mp3tager/string-utilities.html">
<meta property="og:type" content="website">
<meta property="og:site_name" content="kusaku.su">
<meta property="og:image" content="https://kusaku.su/avatar.webp">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="String Utilities - Turbo Pascal Programs">
<meta name="twitter:description" content="String Utilities - Turbo Pascal program by Kirill Arkhipenko (kusaku, retrewert, aks1983).">
<meta name="twitter:image" content="https://kusaku.su/avatar.webp">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<script src="https://cdn.tailwindcss.com"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<style>
        html.light body { background: #ffffff; color: #24292f; }
        html.dark body { background: #0d1117; color: #c9d1d9; }
        html.light .bg-white { background-color: #ffffff; }
        html.dark .bg-white { background-color: #161b22; }
        html.light .text-gray-600 { color: #57606a; }
        html.dark .text-gray-600 { color: #8b949e; }
        html.light .text-gray-700 { color: #24292f; }
        html.dark .text-gray-700 { color: #c9d1d9; }
        html.light .text-gray-900 { color: #24292f; }
        html.dark .text-gray-900 { color: #c9d1d9; }
        html.light .border-gray-200 { border-color: #d0d7de; }
        html.dark .border-gray-200 { border-color: #30363d; }
        html.light .hover\:bg-gray-50:hover { background-color: #f6f8fa; }
        html.dark .hover\:bg-gray-50:hover { background-color: #21262d; }

        /* Link hover effects */
        html.light a:hover { color: #0969da; }
        html.dark a:hover { color: #1f6feb; }
        html.dark pre { background: #161b22 !important; }
        html.dark pre code { color: #c9d1d9; background: transparent !important; }
        html.dark .hljs { background: #161b22 !important; color: #c9d1d9; }
        html.dark .hljs-keyword { color: #ff7b72; }
        html.dark .hljs-string { color: #a5d6ff; }
        html.dark .hljs-number { color: #79c0ff; }
        html.dark .hljs-comment { color: #8b949e; }
        html.dark .hljs-function { color: #d2a8ff; }
        html.dark .hljs-variable { color: #ffa657; }
    </style>
<script>
        const getSystemPreference = () => window.matchMedia('(prefers-color-scheme: dark)').matches;
        const applyTheme = () => {
            const theme = localStorage.theme ?? 'system';
            const isDark = theme === 'system' ? getSystemPreference() : theme === 'dark';
            document.documentElement.classList.toggle('light', !isDark);
            document.documentElement.classList.toggle('dark', isDark);
        };
        document.readyState === 'loading' ? document.addEventListener('DOMContentLoaded', applyTheme) : applyTheme();
        hljs.highlightAll();
    </script>    <script>
        // Register Pascal language for highlight.js
        hljs.registerLanguage('pascal', function(hljs) {
            return {
                keywords: {
                    keyword: 'and array begin case const div do downto else end file for function goto if in label mod nil not of or packed procedure program record repeat set then to type until var while with',
                    built_in: 'boolean char integer real text string',
                    literal: 'true false'
                },
                contains: [
                    hljs.C_LINE_COMMENT_MODE,
                    hljs.C_BLOCK_COMMENT_MODE,
                    hljs.APOS_STRING_MODE,
                    hljs.QUOTE_STRING_MODE,
                    hljs.C_NUMBER_MODE
                ]
            };
        });
    </script>

<script async src="https://www.googletagmanager.com/gtag/js?id=G-J8N1Q1GVVB"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-J8N1Q1GVVB');
</script>
<script type="text/javascript">
    (function(m,e,t,r,i,k,a){
        m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
        m[i].l=1*new Date();
        for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
        k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)
    })(window, document,'script','https://mc.yandex.ru/metrika/tag.js?id=105986243', 'ym');
    ym(105986243, 'init', {ssr:true, webvisor:true, clickmap:true, accurateTrackBounce:true, trackLinks:true});
</script>
</head>
<body class="min-h-screen p-4 sm:p-6 lg:p-8">
    <div class="max-w-7xl mx-auto">
        <nav class="mb-6">
            <a href="/legacy/turbopascal/turbopascal.html" class="inline-flex items-center text-sm font-medium text-gray-600 hover:text-gray-900 transition-colors">
                <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                </svg>
                Back to Turbo Pascal Projects
            </a>
        </nav>
        <h1 class="text-3xl font-bold text-gray-900 mb-4">String Utilities</h1>
        <p class="text-gray-600 mb-6">String manipulation utilities used by the MP3 tag editor. Includes functions for text processing and normalization.</p>
        <div class="bg-white border border-gray-200 rounded-xl p-6 mb-6">
            <h2 class="font-semibold text-gray-900 mb-4">Source Code:</h2>
            <pre><code class="language-pascal">function EmptyTag(Rec:TKeys):boolean;

var i: integer;
    Ch: char;

begin
     i:=1;
     EmptyTag:=True;
     case Rec of
     Title..Album,Comment:
              case Rec of
                    Title:   EmptyTag:=(Tag.Title=Blank30);
                    Artist:  EmptyTag:=(Tag.Artist=Blank30);
                    Album:   EmptyTag:=(Tag.Album=Blank30);
                    Comment: EmptyTag:=(Tag.Comment=Blank30);
              end;

     Year:    repeat
                  EmptyTag:=(Tag.Year[i]=Blank);
                  Inc(i);
              until not (Ch=Blank) or (i=YearRecLen);

     Genre:  EmptyTag:=(Tag.Genre=#255);
     else WriteLn(StatMsg[IEr],&#x27;,&#x27;,KeySet[Rec],&#x27;,&#x27;,i);
     end;
end;


function ConvGen(var S:string):string;
begin
     ConvGen:=S;
end;


function StrEd(S: string; Mode: TKeys; RL: Byte): string;

var i:  byte;
    S2: string;

begin
case Mode of
Capit:  begin
          S:=StrEd(S,LowCase,0);
          if S[1] in [&#x27;a&#x27;..&#x27;z&#x27;] then S[1]:=Chr(Ord(S[1])-32);
          for i:=Length(S) downto 2 do
              if (S[i-1]=Blank) and (S[i] in [&#x27;a&#x27;..&#x27;z&#x27;])
              then S[i]:=Chr(Ord(S[i])-32);
          StrEd:=S;
      end;
UnCapit: begin
          S:=StrEd(S,UpCase,0);
          if S[1] in [&#x27;A&#x27;..&#x27;Z&#x27;] then S[1]:=Chr(Ord(S[1])+32);
          for i:=Length(S) downto 2 do
              if (S[i-1]=Blank) and (S[i] in [&#x27;A&#x27;..&#x27;Z&#x27;])
              then S[i]:=Chr(Ord(S[i])+32);
          StrEd:=S;
       end;
UpCase:  begin
          for i:=1 to Length(S) do
          if S[i] in [&#x27;a&#x27;..&#x27;z&#x27;] then S[i]:=Chr(Ord(S[i])-32);
          StrEd:=S;
      end;
LowCase: begin
          for i:=1 to Length(S) do
          if S[i] in [&#x27;A&#x27;..&#x27;Z&#x27;] then S[i]:=Chr(Ord(S[i])+32);
          StrEd:=S;
      end;
ReplUS: begin
            for i:=1 to Length(S) do
                if S[i]=US then S[i]:=Blank;
            StrEd:=S;
        end;
Normize: begin
            S:=StrEd(S,ReplUS,1);
            while (S[1]=Blank) and (Length(S)&gt;0) do Delete(S,1,1);
            for i:=Length(S) downto 2 do
            if (S[i]=Blank) and (S[i-1]=Blank) then Delete(S,i,1);
            WriteLn(S);
            if Length(S) &lt; RL then while Length(S) &lt; RL do S:= S + Blank;
            if Length(S) &gt; RL then Delete(S, RL + 1, Length(S) - RL);
            StrEd:=S;
         end;
end;
end;

procedure Match;

begin
with Tag do begin
     Title:=StrEd(Title,Normize,NormRecLen);
     Artist:=StrEd(Artist,Normize,NormRecLen);
     Album:=StrEd(Album,Normize,NormRecLen);
     Comment:=StrEd(Comment,Normize,NormRecLen);
{with Options do begin
     if Capit then begin
     Title:=StrEd(Title,Capit,NormRecLen);
     Artist:=StrEd(Artist,Capit,NormRecLen);
     Album:=StrEd(Album,Capit,NormRecLen);
     Comment:=StrEd(Comment,Capit,NormRecLen);
     end;
     if UnCapit then begin
     Title:=StrEd(Title,UnCapit,NormRecLen);
     Artist:=StrEd(Artist,UnCapit,NormRecLen);
     Album:=StrEd(Album,UnCapit,NormRecLen);
     Comment:=StrEd(Comment,UnCapit,NormRecLen);
     end;
     if UpCase then begin
     Title:=StrEd(Title,UpCase,NormRecLen);
     Artist:=StrEd(Artist,UpCase,NormRecLen);
     Album:=StrEd(Album,UpCase,NormRecLen);
     Comment:=StrEd(Comment,UpCase,NormRecLen);
     end;
     if LowCase then begin
     Title:=StrEd(Title,LowCase,NormRecLen);
     Artist:=StrEd(Artist,LowCase,NormRecLen);
     Album:=StrEd(Album,LowCase,NormRecLen);
     Comment:=StrEd(Comment,LowCase,NormRecLen);
     end;
end;}
end;
end;



function ReadParam: TStat;

var
    P,S:   string;
    i,n:   byte;
    Key:   TKeys;

begin
    ReadParam:=Ok;
    for i:=2 to ParamCount do
        for Key:=Low(TKeys) to High(TKeys) do
            if StrEd(Copy(ParamStr(i),1,Length(KeySet[Key])),LowCase,1)=KeySet[Key] then
            case Key of
            Title:   if EmptyTag(Title) then Tag.Title:=Copy(ParamStr(i),1,Length(KeySet[Key]));
            Artist:  if EmptyTag(Artist) then Tag.Artist:=Copy(ParamStr(i),1,Length(KeySet[Key]));
            Album:   if EmptyTag(Album) then Tag.Album:=Copy(ParamStr(i),1,Length(KeySet[Key]));
            Year:    if EmptyTag(Year) then Tag.Year:=Copy(ParamStr(i),1,Length(KeySet[Key]));
            Genre:   if EmptyTag(Genre) then Tag.Genre:=Copy(ParamStr(i),1,Length(KeySet[Key]));
            Comment: if EmptyTag(Comment) then Tag.Comment:=Copy(ParamStr(i),1,Length(KeySet[Key]));
            ReWrTag: Options.ReWrTag:=True;
            Capit:   Options.Capit:=True;
            UnCapit: Options.UnCapit:=True;
            UpCase:  Options.UpCase:=True;
            LowCase: Options.LowCase:=True;
            ReplUS:  Options.ReplUS:=True;
            Normize: Options.Normize:=True;
            else ReadParam:=PEr;
            end;
end;</code></pre>
        </div>
    </div>
</body>
</html>