<!DOCTYPE html>
<html lang="en" class="light">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Registration End - Turbo Pascal Programs</title>
<meta name="description" content="Registration End - Turbo Pascal program by Kirill Arkhipenko (kusaku, retrewert, aks1983).">
<meta name="keywords" content="Kirill Arkhipenko, Кирилл Архипенко, kusaku, retrewert, aks1983, legacy">
<meta name="author" content="Kirill Arkhipenko">
<link rel="canonical" href="https://kusaku.su/legacy/turbopascal/bbs/registration-end.html">
<link rel="alternate" hreflang="en" href="https://kusaku.su/legacy/turbopascal/bbs/registration-end.html">
<link rel="alternate" hreflang="ru" href="https://kusaku.su/legacy/turbopascal/bbs/registration-end.html">
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<meta name="robots" content="index, follow">
<meta property="og:title" content="Registration End - Turbo Pascal Programs">
<meta property="og:description" content="Registration End - Turbo Pascal program by Kirill Arkhipenko (kusaku, retrewert, aks1983).">
<meta property="og:url" content="https://kusaku.su/legacy/turbopascal/bbs/registration-end.html">
<meta property="og:type" content="website">
<meta property="og:site_name" content="kusaku.su">
<meta property="og:image" content="https://kusaku.su/avatar.webp">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Registration End - Turbo Pascal Programs">
<meta name="twitter:description" content="Registration End - Turbo Pascal program by Kirill Arkhipenko (kusaku, retrewert, aks1983).">
<meta name="twitter:image" content="https://kusaku.su/avatar.webp">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<script src="https://cdn.tailwindcss.com"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<style>
        html.light body { background: #ffffff; color: #24292f; }
        html.dark body { background: #0d1117; color: #c9d1d9; }
        html.light .bg-white { background-color: #ffffff; }
        html.dark .bg-white { background-color: #161b22; }
        html.light .text-gray-600 { color: #57606a; }
        html.dark .text-gray-600 { color: #8b949e; }
        html.light .text-gray-700 { color: #24292f; }
        html.dark .text-gray-700 { color: #c9d1d9; }
        html.light .text-gray-900 { color: #24292f; }
        html.dark .text-gray-900 { color: #c9d1d9; }
        html.light .border-gray-200 { border-color: #d0d7de; }
        html.dark .border-gray-200 { border-color: #30363d; }
        html.light .hover\:bg-gray-50:hover { background-color: #f6f8fa; }
        html.dark .hover\:bg-gray-50:hover { background-color: #21262d; }

        /* Link hover effects */
        html.light a:hover { color: #0969da; }
        html.dark a:hover { color: #1f6feb; }
        html.dark pre { background: #161b22 !important; }
        html.dark pre code { color: #c9d1d9; background: transparent !important; }
        html.dark .hljs { background: #161b22 !important; color: #c9d1d9; }
        html.dark .hljs-keyword { color: #ff7b72; }
        html.dark .hljs-string { color: #a5d6ff; }
        html.dark .hljs-number { color: #79c0ff; }
        html.dark .hljs-comment { color: #8b949e; }
        html.dark .hljs-function { color: #d2a8ff; }
        html.dark .hljs-variable { color: #ffa657; }
    </style>
<script>
        const getSystemPreference = () => window.matchMedia('(prefers-color-scheme: dark)').matches;
        const applyTheme = () => {
            const theme = localStorage.theme ?? 'system';
            const isDark = theme === 'system' ? getSystemPreference() : theme === 'dark';
            document.documentElement.classList.toggle('light', !isDark);
            document.documentElement.classList.toggle('dark', isDark);
        };
        document.readyState === 'loading' ? document.addEventListener('DOMContentLoaded', applyTheme) : applyTheme();
        hljs.highlightAll();
    </script>    <script>
        // Register Pascal language for highlight.js
        hljs.registerLanguage('pascal', function(hljs) {
            return {
                keywords: {
                    keyword: 'and array begin case const div do downto else end file for function goto if in label mod nil not of or packed procedure program record repeat set then to type until var while with',
                    built_in: 'boolean char integer real text string',
                    literal: 'true false'
                },
                contains: [
                    hljs.C_LINE_COMMENT_MODE,
                    hljs.C_BLOCK_COMMENT_MODE,
                    hljs.APOS_STRING_MODE,
                    hljs.QUOTE_STRING_MODE,
                    hljs.C_NUMBER_MODE
                ]
            };
        });
    </script>

<script async src="https://www.googletagmanager.com/gtag/js?id=G-J8N1Q1GVVB"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-J8N1Q1GVVB');
</script>
<script type="text/javascript">
    (function(m,e,t,r,i,k,a){
        m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
        m[i].l=1*new Date();
        for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
        k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)
    })(window, document,'script','https://mc.yandex.ru/metrika/tag.js?id=105986243', 'ym');
    ym(105986243, 'init', {ssr:true, webvisor:true, clickmap:true, accurateTrackBounce:true, trackLinks:true});
</script>
</head>
<body class="min-h-screen p-4 sm:p-6 lg:p-8">
    <div class="max-w-7xl mx-auto">
        <nav class="mb-6">
            <a href="/legacy/turbopascal/turbopascal.html" class="inline-flex items-center text-sm font-medium text-gray-600 hover:text-gray-900 transition-colors">
                <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                </svg>
                Back to Turbo Pascal Projects
            </a>
        </nav>
        <h1 class="text-3xl font-bold text-gray-900 mb-4">Registration End</h1>
        <p class="text-gray-600 mb-6">A BBS (Bulletin Board System) script that handles user registration questionnaires. Reads questions from a file, displays them to users with color formatting, collects answers, and saves registration data. Supports conditional question skipping based on Yes/No answers, validates input, and increases user access level based on questions answered. Includes procedures for reading questions, saving answers, skipping questions conditionally, and writing user information to registration files. Written in a Pascal-like BBS scripting language.</p>
        <div class="bg-white border border-gray-200 rounded-xl p-6 mb-6">
            <h2 class="font-semibold text-gray-900 mb-4">Source Code:</h2>
            <pre><code class="language-pascal">//(c) A&lt;S 1983-1999 dO nOT dISTRIBUTE...
Variables
  MsgIn, MsgOut, Def, Colq, Cola, Ch  : String
  Q, Fin, OldReg                      : Logical
  Lng, Type, i, ISecr, Num, Dig       : Number
End

Procedure Save
//Write(&quot;\14*Save*&quot;)
If Type = 1
   WriteLn(&quot;\&quot; + Colq + MsgIn+ &quot;\&quot; + Cola); ReadVar(Def, Lng)
   FileWriteString (1, MsgOut + &quot; &quot; + Def)
Else
   WriteLn(&quot;\&quot; + Colq + MsgIn + &quot;\&quot; + Cola)
   YesNo(Q)
   If Q
      FileWriteString (1, MsgOut + &quot; Да&quot;)
   Else
      FileWriteString (1, MsgOut + &quot; Нет&quot;)
   End
End
   ISecr=ISecr+1
End

Procedure Read
//Write(&quot;\14*Read*&quot;)
NewRead:
FileGetEOF (2, Fin)
If Fin
     Goto FinRead
Else
     FileReadString(2, Ch)
End
If Ch=&quot;[NewQwestion]&quot;
     QRead
     SubString (Ch, Dig, Num-Dig+1, Ch)
     Val (Ch, Type)
     QRead
     SubString (Ch, Dig, Num-Dig+1, Ch)
     Val (Ch, Lng)
     QRead
     SubString (Ch, Dig, Num-Dig+1, MsgIn)
     QRead
     SubString (Ch, Dig, Num-Dig+1, MsgOut)
     QRead
     SubString (Ch, Dig, Num-Dig+1, Def)
     QRead
     SubString (Ch, Dig, Num-Dig+1, Colq)
     QRead
     SubString (Ch, Dig, Num-Dig+1, Cola)
Else
//     WriteLn (&quot;\11Глюки: \03&quot; + Ch)
     GoTo NewRead
End
FinRead:
End

Procedure QRead
     FileReadString (2,Ch)
     GetStringLength (Ch, Num)
     StrPos (&quot;=&quot;, Ch, Dig)
     Dig=Dig+2
End

Procedure Skip
//Write(&quot;\14*Skip*&quot;)
i=Lng
If Q
     If type=3
Var1:
          If i &gt; 0
               Read
               If Fin
                    GoTo FinSkip
               End
               i=i-1
               GoTo Var1
          End
     End
Else
     If type=4
Var2:
          If i &gt; 0
               Read
               If Fin
                    GoTo FinSkip
               End
               i=i-1
               GoTo Var2
          End
     End
End
FinSkip:
End

Procedure Check
//Write(&quot;\14*Check*&quot;)
i=0
GetStringLength (MsgIn, Num)
i=i + Num
GetStringLength (MsgOut, Num)
i=i + Num
GetStringLength (Def, Num)
i=i + Num
If i &gt; 300
   WriteLn(&quot;\04Избавь нас от лукавого!!!&quot;)
End
If (Type &gt; 4) or (Type &lt; 1)
   Type=1
End
If (Lng &gt; 79) or (Lng &lt; 1)
   Lng=70
End
Val (Colq,i)
If (i &gt; 15) or (i &lt; 1)
   Colq=&quot;10&quot;
End
Val (Cola,i)
If (i &gt; 15) or (i &lt; 1)
   Cola=&quot;13&quot;
End
End

Procedure ExitReg
//Write(&quot;\14*ExitReg*&quot;)
WriteLn (&quot;\11Спасибо за ответы.&quot;)
If Not OldReg
   $SECR = $SECR + ISecr
   WriteLn (&quot;\11Ваш уровень доступа поднят на &quot; + ISecr + &quot; и составляет &quot; + $SECR + &quot;...&quot;)
End
//WriteLn (&quot;\10Хотите включить в анкету свои вопросы ?&quot;)
//NoYes (Q)
End

Procedure WriteInfo
//Write(&quot;\14*WriteInfo*&quot;)
FileWriteString (1, &quot;***************************************************************************&quot;)
FileWriteString (1, &quot;Основные сведения:&quot;)
FileWriteString (1, &quot;Зарегистрирован на BBS как: &quot; + $NAME)
FileWriteString (1, &quot;Псевдоним: &quot; + $ALAS + &quot; ;) \08 Пароль: &quot; + $PSWD)
FileWriteString (1, &quot;Уровень доступа до регистрации: &quot; + $SECR)
FileWriteString (1, &quot;Телефон голосовой / модемный: &quot;+$HPHN +&quot; / &quot;+ $BPHN )
FileWriteString (1, &quot;Место звонка: &quot;+$LOCA)
FileWriteString (1, &quot;Дата рождения: &quot;+$DAOB)
FileWriteString (1, &quot;Место работы/учебы: &quot;+$ORGZ)
FileWriteString (1, &quot;***************************************************************************&quot;)
End

Procedure Welcome
Clear
FileExists (&quot;C:\BBS\USERS\&quot; + $FNAM + &quot;.REG&quot;, OldReg)
If OldReg
     FileDisplay (&quot;help2.txt&quot;)
     NoYes(Q)
     If Q
        FileDelete(&quot;C:\BBS\USERS\&quot; + $FNAM + &quot;.REG&quot;)
     End
Else
     FileDisplay (&quot;help1.txt&quot;)
End
End

Program

Welcome

YesNo (Q)

If Not Q
   GoTo EndReg
End

FileAppend (1,&quot;C:\BBS\USERS\&quot; + $FNAM + &quot;.REG&quot;)
FileOpen (2,&quot;C:\BBS\USERS\QWEST.TXT)

WriteInfo
NewQwest:
Read
If Fin
     GoTo EndReg
End
Check
Save
Skip
If Fin
     GoTo EndReg
End
GoTo NewQwest
EndReg:
ExitReg
FileClose (1)
FileClose (2)
//If Q
//     Call sma.tsr
//     Exit
//Else
     Exit
//End
End</code></pre>
        </div>
    </div>
</body>
</html>